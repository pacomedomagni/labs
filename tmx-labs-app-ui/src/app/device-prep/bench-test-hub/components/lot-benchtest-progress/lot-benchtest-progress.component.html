<div class="bg-white border-2 border-black rounded-lg p-8">
  <h2 class="text-3xl font-bold mb-6">Lot Benchtest Progress</h2>   
  <div class="flex gap-4">
    <mat-form-field appearance="outline" class="custom-field w-[400px]">
      <mat-label>Select Lot ID</mat-label>
      <mat-select id="lot-select" [ngModel]="selectedLotId()" (ngModelChange)="onLotSelected($event)" [disabled]="isLoadingLots()">
        @if (deviceLots().length === 0 && !isLoadingLots()) {
          <mat-option disabled>
            No lots available
          </mat-option>
        }
        @if (isLoadingLots()) {
          <mat-option disabled>
            Loading lots...
          </mat-option>
        }
        @for (lot of deviceLots(); track lot.lotSeqID) {
          <mat-option [value]="lot.lotSeqID">
            {{ lot.name }}
          </mat-option>
        }
      </mat-select>
    </mat-form-field>
    <div class="button-container">
      <button 
        mat-flat-button 
        color="primary" 
        class="custom-button"
        (click)="markAsBenchtested()"
        [disabled]="!canVerify()">
        MARK AS BENCHTESTED
      </button>
    </div>
  </div>

  <!-- Progress Bar -->
  <div class="grid grid-cols-[1fr_auto] gap-4 items-center mb-8">
    <div class="w-full bg-gray-300 rounded-full h-8">
      <div class="bg-blue-600 h-8 rounded-full" [style.width.%]="percentTested() > 100 ? 100 : percentTested()"></div>
    </div>
    <div class="text-xl text-gray-600 whitespace-nowrap">{{ successCount() }} / {{ requiredCount() }} devices tested</div>
  </div>

  <!-- Stats Grid -->
  <div class="grid grid-cols-4 gap-4">
    <div class="border-2 border-gray-300 rounded-lg p-6 text-center bg-gray-50">
      <p class="text-xl font-semibold text-gray-700 mb-2">Lot Size</p>
      <p class="text-3xl font-bold text-gray-900">{{ lotSize() || '—' }}</p>
    </div>
    <div class="border-2 border-gray-300 rounded-lg p-6 text-center bg-gray-50">
      <p class="text-xl font-semibold text-gray-700 mb-2">Required ({{ requiredPercentage() }}%)</p>
      <p class="text-3xl font-bold text-gray-900">{{ requiredCount() || '—' }}</p>
    </div>
    <div class="border-2 border-gray-300 rounded-lg p-6 text-center bg-gray-50">
      <p class="text-xl font-semibold text-gray-700 mb-2">Benchtested (Pass)</p>
      <p class="text-3xl font-bold text-gray-900">{{ successCount() || '—' }}</p>
    </div>
    <div class="border-2 border-gray-300 rounded-lg p-6 text-center bg-gray-50">
      <p class="text-xl font-semibold text-gray-700 mb-2">Benchtested (All)</p>
      <p class="text-3xl font-bold text-gray-900">{{ testedDevicesCount() || '—' }}</p>
    </div>
  </div>
</div>
